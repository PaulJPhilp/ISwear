---
import StationMarker from './station/StationMarker.astro';
import { StationName } from './station/StationName';

interface Props {
  title: string;
  themeClass?: string;
}

/***
// Types
interface TitleMapping {
  [key: string]: string;
}

interface StationError {
  code: 'STATION_NOT_FOUND';
  message: string;
}

// Constants
const TITLE_MAPPINGS: TitleMapping = {
  'Increasing Modularity': 'Law of Increasing Modularity',
};

const MAX_TITLE_LENGTH = 17;

// Utility functions


function formatTitle(text: string): string {
  if (text.length <= MAX_TITLE_LENGTH) return text;

  const spaceIndex = text.substring(0, MAX_TITLE_LENGTH).lastIndexOf(' ');
  if (spaceIndex === -1) return text;

  return `${text.slice(0, spaceIndex)}\n${text.slice(spaceIndex + 1)}`;
}

async function findStationEntry(title: string): Promise<CollectionEntry<'stations'>> {
  const mappedTitle = TITLE_MAPPINGS[title] || title;
  const slug = toSlug(mappedTitle);

  // Try exact match first
  const exactMatch = await getEntry('stations', slug);
  if (exactMatch) return exactMatch;

  // Try partial match
  const allStations = await getCollection('stations');
  const partialMatch = allStations.find((entry) => entry.id.startsWith(slug));

  if (partialMatch) return partialMatch;

  throw {
    code: 'STATION_NOT_FOUND',
    message: `Station entry not found: ${title} (slug: ${slug})`,
  } as StationError;
}
***/

const { title } = Astro.props;

//const debug = import.meta.env.DEV || import.meta.env.DEBUG?.toLowerCase() === 'true'
const debug = false;
---

<div class="relative w-full flex justify-center items-center transition-transform duration-200 ease-in-out">
  {(<StationName name={title} />)}
  <div class="absolute">
    {(<StationMarker debug={debug} />)}
  </div>
</div>
